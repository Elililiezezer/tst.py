<script>
  document.addEventListener("DOMContentLoaded", () => {
    const container = document.getElementById("tabela-container");
    const input = document.getElementById("searchInput");

    fetch("tabela-pescados.csv")
      .then((response) => {
        if (!response.ok) {
          throw new Error(`Erro HTTP: ${response.status}`);
        }
        return response.text();
      })
      .then((texto) => {
        const linhas = texto.trim().split("\n");
        if (linhas.length === 0) {
          container.textContent = "CSV vazio.";
          return;
        }

        const table = document.createElement("table");
        const thead = document.createElement("thead");
        const trHead = document.createElement("tr");
        linhas[0].split(",").forEach((col) => {
          const th = document.createElement("th");
          th.textContent = col;
          trHead.appendChild(th);
        });
        thead.appendChild(trHead);
        table.appendChild(thead);

        const tbody = document.createElement("tbody");
        linhas.slice(1).forEach((linha) => {
          const tr = document.createElement("tr");
          linha.split(",").forEach((cel) => {
            const td = document.createElement("td");
            td.textContent = cel;
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
        table.appendChild(tbody);
        container.appendChild(table);

        input.addEventListener("keyup", () => {
          const filtro = input.value.toLowerCase();
          Array.from(tbody.rows).forEach((row) => {
            const textoRow = row.textContent.toLowerCase();
            row.classList.toggle("hidden", !textoRow.includes(filtro));
          });
        });
      })
      .catch((error) => {
        console.error("Erro ao carregar a tabela:", error);
        container.textContent = `Erro ao carregar a tabela: ${error.message}`;
      });
  });
</script>
